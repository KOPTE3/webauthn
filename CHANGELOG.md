# Changelog

## 1.9.7

* Из таска запуска тестов убран модуль TestTools

## 1.9.2-1.9.6

* Исправлено получение email из менеджера аккаунтов для заданных учетных записей
* Исправлена авторизация для учетных записей с уже имеющимися авторизационными данными
* Исправлен запуск тестов c множественным набором (--suite=,,,)
* Добавлен метод list в менеджер аккаунтов 
* Добавлена тестовая куку qa
* Добавлен модуль debug, c последюущей заменой console.log с NODE_DEBUG 

* Модуль `@qa/wdio-api-mail.ru` переименован в `@qa/wdio-api`. Из-за несовместимости с локальными конфигами пока поддерживается оба варианта.
* В `utils/tabs.js` перенесен в `browser.switchToNextTab`, который доступен в `@qa/wdio-api.`

## 1.9.1

* В рамках работы над скафолдером:
	* Вызов `TestTools.support.extend` заменен на модуль `deepmerge`
	* `store.helpers` -> `store/helpers`


## 1.9.0

* Хуки для Mocha вынесены в отдельный пакет `@qa/wdio-mocha-hooks`.


## 1.8.1

* Исправлены ошибки авторизации. Теперь авторизация не проверят sdc-куку


## 1.8.0

Добавлены методы для работы с паролями:

* store/authorization/passwords — позволяет получить предопределенный пароль заданой сложности
* utils/account.generatePassword — позволяет получить случайный пароль
* utils/account.passwordStrength — позволяет определить сложность пароля


## 1.7.0

* Поддержал новую версию API авторизационного сервиса


## 1.6.0

* Метод `utils/registerLogger` теперь первым параметром принимает событие логирования. <br />
Допустимые значения: complete, send, end, error, start, stop, success

* В Steps добавлены проки-методы `setAjaxLog` и `getAjaxLog`, которые могу мониторить сетевые xhr-запросы. <br />
Пример использования: <br />

```js
let method = 'messages/status';

FileSearch.setAjaxLog('send', method);

fileSearch.goToFolder('sent');

FileSearch.getAjaxLog(method, stack => {
	return stack.some(request => {
		return !request.settings.url.includes('https');
	});
});
```
В этом примере, проверяется с каким типом протокола отправляется запрос `messages/status`


## 1.5.0

* Все фичи теперь сгруппированы по номеру таска

* В `describe` и `it` убраны паразитирующие асинхронные параметры  

* В eslint выключено `array-bracket-spacing` и `padded-blocks`   

Было:

```js
describe('НЕ AJAX. Ответ на письмо. Забытое вложение. ' +
	'Проверить отсутствие попапа для полного ответа с текстом в теле ' +
	'(текст для которого не должен появляться попап)', 
	() => {
		before(() => {
			Compose.auth();
		});
	}
);
```

Стало:

```js
describe('НЕ AJAX. Ответ на письмо. Забытое вложение. ' +
	'Проверить отсутствие попапа для полного ответа с текстом в теле ' +
	'(текст для которого не должен появляться попап)',  () => {

	before(() => {
		Compose.auth();
	});
});
```

* Добавлены анонимные `describe`

Было:

```js
describe('TESTMAIL-31906', () => {});
```

Стало:

```js
describe(() => {});
```

Было:

```js
let name = path.basename((module.parent.options ? module.parent : module).filename, '.js');

describe(name, () => {});
```

Стало:

```js
describe(() => {});
```

* Префикс с номером таска в блоке `describe` подставляется автоматически:

Было:

```js
describe(('TESTMAIL-31697: Список писем. Сохранение поисковых запросов') => {});
```

Стало:

```js
describe(('Список писем. Сохранение поисковых запросов') => {});
```

## 1.4.0

* Добавлены учетные записи для OAuth-авторизации (включая социальные сервисы)

* Измненения в модуле TestTools.support:
	* Теперь в методе support:
		* Аргумент --grep также применяется к дополнительному набору тестов
		* Данные о тестовом наборе передаются в конструктор, а не в сам метод
		* Добавлен колбек для фильтрации тестов

	* Добавлен метод features, который возращает список фич по названиям директорий
	* Добавлен метод excluded, который возвращает список фич исключеных из прогона
	* Добавлен метод branches, который возвращает список проектных веток

* Исправлено поведение создания локального конфига. Теперь он создается только на локальной машине разработчика.
* Добавлен хук branches, который сохраняет во временный файл список проектных веток
* В конфигурационных файлах исправлен вызов метода TestTools#support.suites, который теперь умеет фильтровать тесты ориентируясь на операционное окружение.

* Удалены дубликаты методов

* Расширен список методов для управления учетным записями:
	* Создание учетных записей с заданными харакетеристиками (`utils/user/add`)
	* Редактирования учетных записей (`utils/user/edit`)
	* Шаблон пользовательских харакетеристик (`utils/user/info`)

## 1.3.0

* Добавлены методы для работы с учетными записями пользователей:
	* `store/authorization/accounts.get`
	* `store/authorization.discard`

Теперь возможно получить учетную запись из локального хранилища.

* Добавлен набор методов для получения списка провайдеров с учетом различных фильтров, в т.ч. и топа:
	* `store/authorization/providers`

* Исправлена передача внешних опций командной строки (например, `--mochaOpts.timeout=90000`)

* Убран визуальный мусор глоба в debug-режиме

* Добавлен метод reload, который обновляет сессию

* Добавлен метод refresh, который обновляет страницу

* Кеш теперь чистится перед каждым запуском тестов

* Добавлена поддержка локальных конфигов

* Исправлены capabilities — теперь можно передавать дополнительные опции

* В тестовый набор теперь можно передавать дополниельные опции (например `exclude`, для исключения из прогона списка файлов).

* В capabilities добавлен Safari

* Теперь зафейленные тесты делают повторную попытку

* Исправлены умолчательные ошибки с waitUntil

* Исправлена публикация отчетов о прогоне в JIRA

* Добавлены новые команды:
	* addHiddenValue
	* setHiddenValue
	* waitForUrl

* Добавле автоматический запуск сервера

* Исправлено зависание системы при передаче несуществующего тестового набора

* В утилитах появилось несколько сущностей:
	* Константы
	* Вызовы внутреннего апи
	* Работа с фичами
	* Модуль для работы с Ajax запросами

* Добавлен хук, который проверяет обратно-несовместимые версии пакетов

* Обновлены пакеты:
	* account-manager
	* eslint-config-mail.ru
	* grunt-test-runner
	* test-runner
	* wd-capabilities
	* wdio-api-mail.ru
